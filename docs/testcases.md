1. Инвентаризация

Есть N issue types (IT), каждый из которых описывается SC.

Несколько из IT настроены на инвентаризацию. Инвентаризация - также часть SC.

2 сервиса:
 - заявки
 - инвентаризация

Сценарий 1

Клиент инициирует процесс инвентаризации
                                                Через REST создается SC с начальным контекстом. В контексте - всё, что нужно для создания инвентаризации и заявки
                                                SC отправляет сообщение "создать процесс инвентаризации" в inventory сервис
                                                Inventory service создает процесс инвентаризации и отправляет сообщение "inventory created" с топиком "inventory/<inventory id>" и id sc
                                                Сообщение "inventory created" прилетает на сервер SC
                                                Сервер SC по id SC загружает инстанс SC
                                                Сервер SC подписывает SC с <id> на топик inventory/<inventory id>
                                                SC обрабатывает сообщение:
                                                SC отправляет соообщение "создать заявку", заполняя атрибут inventory_process значением, полученным из сообщения "inventory created"
                                                Сервис заявок получает сообщение "создать заявку", создаёт заявку и отправляет сообщение "заявка создана" с Id заявки
                                                Сервер SC по id загружает SC, подписывает SC на топик и обрабатывает сообщение
Заявка на инвентаризацию прилетает исполнителю
                                                SC отправляет push уведомление через отправку сообщения в сервис уведомлений
Исполнитель проводит инвентаризацию
                                                Клиент через REST обращается к inventory сервису с методом start_inventory
                                                inventory service убеждается, что указанный inventory существует и в нужном статусе и
                                                    отправляет сообщение "start inventory" в сервер SC с топиком inventory/<inventory id>
                                                Клиент так же через REST редактирует инвентаризацию (кроме статуса)
Исполнитель закрывает заявку
                                                Клиент->REST->issue service->E:"close issue requested"->SSC->SC.issue_status='closed'->
                                                SC->inventory service:A:"close inventory"->
                                                inventory service->SC:"inventory closed"

Заявка прилетает проверяющему
Проверяющий закрывает закрывает заявку
